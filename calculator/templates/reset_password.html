<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>重置密码</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#64748b'
                    },
                    borderRadius: {
                        'none': '0px',
                        'sm': '4px',
                        DEFAULT: '8px',
                        'md': '12px',
                        'lg': '16px',
                        'xl': '20px',
                        '2xl': '24px',
                        '3xl': '32px',
                        'full': '9999px',
                        'button': '8px'
                    }
                }
            }
        }
    </script>
    <style>
        :where([class^="ri-"])::before { content: "\f3c2"; }
        .password-strength-0 { width: 25%; background-color: #ef4444; }
        .password-strength-1 { width: 50%; background-color: #f59e0b; }
        .password-strength-2 { width: 75%; background-color: #10b981; }
        .password-strength-3 { width: 100%; background-color: #059669; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center">
    <div class="w-full max-w-md p-8 bg-white rounded-lg shadow-lg">
        <h1 class="text-3xl font-bold text-center mb-2">重置密码</h1>
        <p class="text-gray-600 text-center mb-8">请设置您的新密码</p>
        
        <form id="resetForm" class="space-y-6">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">新密码</label>
                <div class="relative">
                    <input type="password" id="password" class="w-full px-4 py-2 border border-gray-300 rounded-button focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" required>
                    <button type="button" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 cursor-pointer w-6 h-6 flex items-center justify-center" onclick="togglePassword('password')">
                        <i class="ri-eye-line"></i>
                    </button>
                </div>
                <div class="mt-2">
                    <div class="h-1 bg-gray-200 rounded-full overflow-hidden">
                        <div id="strengthBar" class="h-full transition-all duration-300"></div>
                    </div>
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">确认密码</label>
                <div class="relative">
                    <input type="password" id="confirmPassword" class="w-full px-4 py-2 border border-gray-300 rounded-button focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" required>
                    <button type="button" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 cursor-pointer w-6 h-6 flex items-center justify-center" onclick="togglePassword('confirmPassword')">
                        <i class="ri-eye-line"></i>
                    </button>
                </div>
                <p id="matchStatus" class="mt-1 text-sm"></p>
            </div>

            <div class="space-y-2">
                <p class="text-sm text-gray-600">密码必须满足：</p>
                <ul class="text-sm text-gray-600 space-y-1">
                    <li id="lengthCheck" class="flex items-center gap-2">
                        <i class="ri-close-circle-line text-red-500"></i>
                        至少 8 个字符
                    </li>
                    <li id="numberCheck" class="flex items-center gap-2">
                        <i class="ri-close-circle-line text-red-500"></i>
                        包含数字
                    </li>
                    <li id="letterCheck" class="flex items-center gap-2">
                        <i class="ri-close-circle-line text-red-500"></i>
                        包含字母
                    </li>
                </ul>
            </div>

            <button type="submit" id="submitBtn" class="w-full bg-primary text-white py-2 px-4 rounded-button hover:bg-primary/90 transition-colors cursor-pointer flex items-center justify-center" disabled>
                确认修改
            </button>
        </form>

        <div class="mt-6 text-center">
            <a href="/login" class="text-sm text-primary hover:text-primary/80">返回登录</a>
        </div>
    </div>

    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full mx-4">
            <div class="text-center">
                <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="ri-check-line text-green-500 text-3xl"></i>
                </div>
                <h3 class="text-xl font-semibold mb-2">密码修改成功</h3>
                <p class="text-gray-600 mb-6">您的密码已经成功修改，请使用新密码登录。</p>
                <button onclick="redirectToLogin()" class="bg-primary text-white py-2 px-4 rounded-button hover:bg-primary/90 transition-colors cursor-pointer">
                    返回登录
                </button>
            </div>
        </div>
    </div>

    <script>
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const icon = input.nextElementSibling.querySelector('i');
            if (input.type === 'password') {
                input.type = 'text';
                icon.className = 'ri-eye-off-line';
            } else {
                input.type = 'password';
                icon.className = 'ri-eye-line';
            }
        }
        function checkPasswordStrength(password) {
            let strength = 0;
            if (password.length >= 8) {
                strength++;
                document.getElementById('lengthCheck').innerHTML = '<i class="ri-checkbox-circle-line text-green-500"></i> 至少 8 个字符';
            } else {
                document.getElementById('lengthCheck').innerHTML = '<i class="ri-close-circle-line text-red-500"></i> 至少 8 个字符';
            }
            
            if (/\d/.test(password)) {
                strength++;
                document.getElementById('numberCheck').innerHTML = '<i class="ri-checkbox-circle-line text-green-500"></i> 包含数字';
            } else {
                document.getElementById('numberCheck').innerHTML = '<i class="ri-close-circle-line text-red-500"></i> 包含数字';
            }
            
            if (/[a-zA-Z]/.test(password)) {
                strength++;
                document.getElementById('letterCheck').innerHTML = '<i class="ri-checkbox-circle-line text-green-500"></i> 包含字母';
            } else {
                document.getElementById('letterCheck').innerHTML = '<i class="ri-close-circle-line text-red-500"></i> 包含字母';
            }

            const strengthBar = document.getElementById('strengthBar');
            strengthBar.className = `h-full transition-all duration-300 password-strength-${strength}`;
            
            return strength === 3;
        }

        document.getElementById('password').addEventListener('input', function() {
            const password = this.value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const isValid = checkPasswordStrength(password);
            
            if (confirmPassword) {
                checkPasswordMatch(password, confirmPassword);
            }
            
            updateSubmitButton();
        });

        document.getElementById('confirmPassword').addEventListener('input', function() {
            const password = document.getElementById('password').value;
            const confirmPassword = this.value;
            checkPasswordMatch(password, confirmPassword);
            updateSubmitButton();
        });

        function checkPasswordMatch(password, confirmPassword) {
            const matchStatus = document.getElementById('matchStatus');
            if (confirmPassword === '') {
                matchStatus.textContent = '';
                matchStatus.className = 'mt-1 text-sm';
                return false;
            } else if (password === confirmPassword) {
                matchStatus.textContent = '密码匹配';
                matchStatus.className = 'mt-1 text-sm text-green-500';
                return true;
            } else {
                matchStatus.textContent = '密码不匹配';
                matchStatus.className = 'mt-1 text-sm text-red-500';
                return false;
            }
        }

        function updateSubmitButton() {
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const submitBtn = document.getElementById('submitBtn');
            
            const isStrengthValid = checkPasswordStrength(password);
            const isMatchValid = password === confirmPassword && confirmPassword !== '';
            
            submitBtn.disabled = !(isStrengthValid && isMatchValid);
        }

        document.getElementById('resetForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.innerHTML = '<i class="ri-loader-4-line animate-spin"></i>';
            submitBtn.disabled = true;
            
            setTimeout(() => {
                document.getElementById('successModal').style.display = 'flex';
            }, 1500);
        });

        function redirectToLogin() {
            window.location.href = '/login';
        }
    </script>
</body>
</html>